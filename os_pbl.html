<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CPU Scheduling Simulator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f6fa;
    padding: 20px;
    color: #333;
  }
  h1 { text-align: center; color: #2f3640; }
  .container { max-width: 700px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  input, select, button {
    padding: 10px; margin: 5px 0; width: 100%; border: 1px solid #ccc; border-radius: 6px;
  }
  button { background-color: #44bd32; color: white; font-weight: bold; cursor: pointer; }
  button:hover { background-color: #4cd137; }
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  table, th, td { border: 1px solid #ddd; }
  th, td { padding: 8px; text-align: center; }
  .gantt {
    display: flex; margin-top: 10px;
  }
  .block {
    background: #74b9ff; color: white; padding: 10px; border-radius: 6px; margin-right: 4px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>CPU Scheduling Simulator</h1>

    <label>Number of Processes:</label>
    <input type="number" id="n" min="1" value="3">

    <div id="processInputs"></div>

    <label>Algorithm:</label>
    <select id="algo">
      <option value="fcfs">FCFS</option>
      <option value="sjf">SJF</option>
      <option value="priority">Priority</option>
      <option value="rr">Round Robin</option>
    </select>

    <div id="quantumDiv" style="display:none;">
      <label>Time Quantum:</label>
      <input type="number" id="quantum" value="3" min="1">
    </div>

    <button onclick="simulate()">Run Simulation</button>

    <div id="result"></div>
  </div>

<script>
document.getElementById("n").addEventListener("input", generateInputs);
document.getElementById("algo").addEventListener("change", () => {
  document.getElementById("quantumDiv").style.display =
    document.getElementById("algo").value === "rr" ? "block" : "none";
});
generateInputs();

function generateInputs() {
  const n = document.getElementById("n").value;
  let html = "";
  for (let i = 0; i < n; i++) {
    html += `
      <h4>Process P${i+1}</h4>
      <label>Burst Time:</label>
      <input type="number" id="bt${i}" min="1" value="5">
      <label>Priority:</label>
      <input type="number" id="pr${i}" min="1" value="${i+1}">
    `;
  }
  document.getElementById("processInputs").innerHTML = html;
}

function simulate() {
  const algo = document.getElementById("algo").value;
  const n = document.getElementById("n").value;
  let processes = [];

  for (let i = 0; i < n; i++) {
    processes.push({
      id: "P" + (i + 1),
      bt: parseInt(document.getElementById("bt" + i).value),
      pr: parseInt(document.getElementById("pr" + i).value)
    });
  }

  let result = "";
  let wt = [], tat = [];

  if (algo === "fcfs") {
    let t = 0;
    for (let i = 0; i < n; i++) {
      wt[i] = t;
      t += processes[i].bt;
      tat[i] = wt[i] + processes[i].bt;
    }
    result = makeTable(processes, wt, tat, "FCFS");
  }

  else if (algo === "sjf") {
    processes.sort((a, b) => a.bt - b.bt);
    let t = 0;
    for (let i = 0; i < n; i++) {
      wt[i] = t;
      t += processes[i].bt;
      tat[i] = wt[i] + processes[i].bt;
    }
    result = makeTable(processes, wt, tat, "SJF");
  }

  else if (algo === "priority") {
    processes.sort((a, b) => a.pr - b.pr);
    let t = 0;
    for (let i = 0; i < n; i++) {
      wt[i] = t;
      t += processes[i].bt;
      tat[i] = wt[i] + processes[i].bt;
    }
    result = makeTable(processes, wt, tat, "Priority Scheduling");
  }

  else if (algo === "rr") {
    let q = parseInt(document.getElementById("quantum").value);
    let rem = processes.map(p => p.bt);
    let t = 0, done;
    wt = Array(n).fill(0);
    tat = Array(n).fill(0);
    do {
      done = true;
      for (let i = 0; i < n; i++) {
        if (rem[i] > 0) {
          done = false;
          if (rem[i] > q) {
            t += q;
            rem[i] -= q;
          } else {
            t += rem[i];
            wt[i] = t - processes[i].bt;
            rem[i] = 0;
          }
        }
      }
    } while (!done);
    for (let i = 0; i < n; i++) tat[i] = wt[i] + processes[i].bt;
    result = makeTable(processes, wt, tat, "Round Robin");
  }

  document.getElementById("result").innerHTML = result;
}

function makeTable(processes, wt, tat, title) {
  let avgWT = (wt.reduce((a,b)=>a+b,0)/wt.length).toFixed(2);
  let avgTAT = (tat.reduce((a,b)=>a+b,0)/tat.length).toFixed(2);
  let html = `<h3>${title}</h3>
  <table>
    <tr><th>Process</th><th>Burst Time</th><th>Waiting Time</th><th>Turnaround Time</th></tr>`;
  for (let i = 0; i < processes.length; i++) {
    html += `<tr><td>${processes[i].id}</td><td>${processes[i].bt}</td><td>${wt[i]}</td><td>${tat[i]}</td></tr>`;
  }
  html += `</table>
  <p><b>Average Waiting Time:</b> ${avgWT}</p>
  <p><b>Average Turnaround Time:</b> ${avgTAT}</p>
  <div class='gantt'>`;
  let time = 0;
  for (let i = 0; i < processes.length; i++) {
    html += `<div class='block'>${processes[i].id}<br>${time} - ${time + processes[i].bt}</div>`;
    time += processes[i].bt;
  }
  html += `</div>`;
  return html;
}
</script>
</body>
</html>
